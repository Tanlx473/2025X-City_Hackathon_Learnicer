<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>物理题目可视化解题工具</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <header class="page-header">
    <div class="title-group">
      <p class="eyebrow">Learnicer</p>
      <h1>物理题目可视化解题工具</h1>
      <p class="subtitle">上传题目图片，查看解析步骤并播放 Canvas 动画</p>
    </div>
  </header>

  <main class="layout">
    <section class="panel upload-panel">
      <h2>上传题目图片</h2>
      <form id="uploadForm" class="upload-form">
        <label class="file-label" for="fileInput">
          <span>选择图片文件</span>
          <input type="file" id="fileInput" name="file" accept="image/*" />
        </label>
        <button type="submit" class="primary-btn">上传并解析</button>
      </form>
      <div id="loading" class="loading" aria-live="polite" role="status" style="display: none;">
        <span class="spinner"></span>
        <span>正在解析图片，请稍候...</span>
      </div>
      <div id="errorBox" class="alert" role="alert" style="display: none;"></div>
    </section>

    <section class="panel results-panel">
      <div class="results-grid">
        <div class="text-column">
          <div class="section-header">
            <h3>解题步骤</h3>
            <p class="hint">按顺序展示后端返回的步骤</p>
          </div>
          <div id="stepsContainer" class="card"></div>

          <div class="section-header">
            <h3>动画指令</h3>
            <p class="hint">供动画模块解析的原始说明</p>
          </div>
          <div id="instructionsContainer" class="card"></div>

          <div class="section-header">
            <h3>题目信息</h3>
            <p class="hint">类型、参数等辅助字段</p>
          </div>
          <div id="metaContainer" class="card"></div>
        </div>

        <div class="canvas-column">
          <div class="section-header">
            <h3>动画演示</h3>
            <p class="hint">播放、暂停或重播示例动画</p>
          </div>
          <canvas id="animationCanvas" width="720" height="420"></canvas>
          <div id="controls" class="controls" style="display: none;">
            <button id="playBtn" type="button">播放</button>
            <button id="pauseBtn" type="button">暂停</button>
            <button id="replayBtn" type="button">重播</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="page-footer">
    <p>后端接口：<code>POST /upload</code> (multipart/form-data, 字段名 <code>file</code>)</p>
  </footer>

  <!-- 引入 animations/ 核心模块（C 同学版本 - 权威实现） -->
  <script src="/animations/animation_base.js"></script>
  <script src="/animations/free_fall.js"></script>
  <script src="/animations/projectile_motion.js"></script>
  <script src="/animations/uniform.js"></script>
  <script src="/animations/uniform_acceleration.js"></script>
  <script src="/animations/uniform_circular.js"></script>
  <script src="/animations/physics_visualizer.js"></script>

  <!-- 全局辅助函数（避免 AnimationBase 调用报错） -->
  <script>
    // updatePhysicsPanel: 占位函数，避免 animation_base.js:368 报错
    // 如果未来需要实时显示物理参数面板，可以在此实现
    function updatePhysicsPanel(animation) {
      // 目前为空实现，仅防止报错
      // 可扩展：更新 DOM 显示速度、加速度等实时数据
    }
  </script>

  <!-- 兼容适配层（A 同学接口 → C 同学实现） -->
  <script src="{{ url_for('static', filename='animation.js') }}"></script>
  <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>
